<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="Arial, sans-serif">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1a73e8"/>
      <stop offset="100%" style="stop-color:#4285f4"/>
    </linearGradient>
    <linearGradient id="agentGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f0fe"/>
      <stop offset="100%" style="stop-color:#d2e3fc"/>
    </linearGradient>
    <linearGradient id="mcpGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fef7e0"/>
      <stop offset="100%" style="stop-color:#feefc3"/>
    </linearGradient>
    <linearGradient id="gcpGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e6f4ea"/>
      <stop offset="100%" style="stop-color:#ceead6"/>
    </linearGradient>
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="900" fill="#f8f9fa"/>
  
  <!-- Title Header -->
  <rect x="0" y="0" width="1200" height="70" fill="url(#headerGrad)"/>
  <text x="600" y="35" text-anchor="middle" fill="white" font-size="24" font-weight="bold">GCP Agent Architecture: Billing Spike Prevention &amp; Cost Monitoring</text>
  <text x="600" y="55" text-anchor="middle" fill="white" font-size="14">Port: ${MCP_SERVER_PORT} | 8 Primary GCP APIs</text>
  
  <!-- Agent Orchestration Layer -->
  <rect x="50" y="90" width="1100" height="180" rx="10" fill="url(#agentGrad)" filter="url(#shadow)"/>
  <text x="600" y="115" text-anchor="middle" font-size="16" font-weight="bold" fill="#1a73e8">AGENT ORCHESTRATION LAYER</text>
  
  <!-- Three Agents -->
  <g transform="translate(100, 135)">
    <rect width="280" height="110" rx="8" fill="white" stroke="#1a73e8" stroke-width="2"/>
    <text x="140" y="25" text-anchor="middle" font-weight="bold" fill="#1a73e8">COST AGENT</text>
    <text x="140" y="50" text-anchor="middle" font-size="12" fill="#5f6368">• Query billing data</text>
    <text x="140" y="68" text-anchor="middle" font-size="12" fill="#5f6368">• Aggregate costs</text>
    <text x="140" y="86" text-anchor="middle" font-size="12" fill="#5f6368">• Compare periods</text>
  </g>
  
  <g transform="translate(460, 135)">
    <rect width="280" height="110" rx="8" fill="white" stroke="#1a73e8" stroke-width="2"/>
    <text x="140" y="25" text-anchor="middle" font-weight="bold" fill="#1a73e8">OPTIMIZATION AGENT</text>
    <text x="140" y="50" text-anchor="middle" font-size="12" fill="#5f6368">• Rightsizing suggestions</text>
    <text x="140" y="68" text-anchor="middle" font-size="12" fill="#5f6368">• Idle resource detection</text>
    <text x="140" y="86" text-anchor="middle" font-size="12" fill="#5f6368">• Spot/CUD recommendations</text>
  </g>
  
  <g transform="translate(820, 135)">
    <rect width="280" height="110" rx="8" fill="white" stroke="#1a73e8" stroke-width="2"/>
    <text x="140" y="25" text-anchor="middle" font-weight="bold" fill="#1a73e8">REMEDIATION AGENT</text>
    <text x="140" y="50" text-anchor="middle" font-size="12" fill="#5f6368">• Execute actions</text>
    <text x="140" y="68" text-anchor="middle" font-size="12" fill="#5f6368">• Approval workflow</text>
    <text x="140" y="86" text-anchor="middle" font-size="12" fill="#5f6368">• Rollback capability</text>
  </g>
  
  <!-- Arrows to MCP Gateway -->
  <path d="M240 245 L240 285 L600 285 L600 310" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M600 245 L600 310" stroke="#5f6368" stroke-width="2" fill="none"/>
  <path d="M960 245 L960 285 L600 285" stroke="#5f6368" stroke-width="2" fill="none"/>
  
  <!-- MCP Gateway -->
  <rect x="450" y="310" width="300" height="50" rx="8" fill="#fbbc04" filter="url(#shadow)"/>
  <text x="600" y="340" text-anchor="middle" font-weight="bold" fill="white">MCP GATEWAY (Port ${MCP_SERVER_PORT})</text>
  
  <!-- Arrow to MCP Server -->
  <path d="M600 360 L600 395" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- MCP Server Layer -->
  <rect x="50" y="395" width="1100" height="220" rx="10" fill="url(#mcpGrad)" filter="url(#shadow)"/>
  <text x="600" y="420" text-anchor="middle" font-size="16" font-weight="bold" fill="#e37400">GCP MCP SERVER (Port ${MCP_SERVER_PORT}) - 8 APIs</text>
  
  <!-- API Boxes - Row 1 -->
  <g transform="translate(70, 440)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">Resource Manager</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">Org hierarchy</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">Projects/Folders</text>
  </g>
  
  <g transform="translate(260, 440)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">Service Usage</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">Enabled services</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">Per project</text>
  </g>
  
  <g transform="translate(450, 440)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">Cloud Billing</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">Cost data</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">SKU pricing</text>
  </g>
  
  <g transform="translate(640, 440)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">Recommender</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">ML suggestions</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">Idle/Rightsizing</text>
  </g>
  
  <!-- API Boxes - Row 2 -->
  <g transform="translate(70, 525)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">Asset Inventory</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">Resource tracking</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">Change feeds</text>
  </g>
  
  <g transform="translate(260, 525)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">Budget API</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">Thresholds</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">Pub/Sub alerts</text>
  </g>
  
  <g transform="translate(450, 525)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">Cloud Monitoring</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">Metrics</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">Custom alerts</text>
  </g>
  
  <g transform="translate(640, 525)">
    <rect width="170" height="70" rx="6" fill="white" stroke="#e37400" stroke-width="2"/>
    <text x="85" y="22" text-anchor="middle" font-weight="bold" font-size="11" fill="#e37400">BigQuery</text>
    <text x="85" y="40" text-anchor="middle" font-size="10" fill="#5f6368">Billing exports</text>
    <text x="85" y="54" text-anchor="middle" font-size="10" fill="#5f6368">Cost analytics</text>
  </g>
  
  <!-- Key Features Box -->
  <g transform="translate(840, 440)">
    <rect width="290" height="155" rx="6" fill="white" stroke="#34a853" stroke-width="2"/>
    <text x="145" y="22" text-anchor="middle" font-weight="bold" font-size="12" fill="#34a853">KEY CAPABILITIES</text>
    <text x="15" y="45" font-size="11" fill="#5f6368">✓ Organization-wide scanning</text>
    <text x="15" y="63" font-size="11" fill="#5f6368">✓ Circuit breaker protection</text>
    <text x="15" y="81" font-size="11" fill="#5f6368">✓ Real-time resource tracking</text>
    <text x="15" y="99" font-size="11" fill="#5f6368">✓ ML-powered recommendations</text>
    <text x="15" y="117" font-size="11" fill="#5f6368">✓ Anomaly detection</text>
    <text x="15" y="135" font-size="11" fill="#5f6368">✓ Conversational interface</text>
  </g>
  
  <!-- Arrow to GCP -->
  <path d="M600 615 L600 650" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- GCP Layer -->
  <rect x="50" y="650" width="1100" height="100" rx="10" fill="url(#gcpGrad)" filter="url(#shadow)"/>
  <text x="600" y="680" text-anchor="middle" font-size="16" font-weight="bold" fill="#34a853">GOOGLE CLOUD PLATFORM</text>
  
  <!-- GCP Services -->
  <text x="600" y="710" text-anchor="middle" font-size="13" fill="#5f6368">
    Compute Engine | Cloud Storage | BigQuery | Cloud SQL | GKE | Cloud Run | Dataflow | Pub/Sub | Cloud Functions | Vertex AI
  </text>
  <text x="600" y="735" text-anchor="middle" font-size="12" fill="#5f6368">
    All enabled services across all projects in your organization
  </text>
  
  <!-- Legend -->
  <rect x="50" y="770" width="1100" height="110" rx="8" fill="white" stroke="#dadce0" stroke-width="1"/>
  <text x="600" y="795" text-anchor="middle" font-weight="bold" fill="#5f6368">LEGEND &amp; IAM REQUIREMENTS</text>
  
  <rect x="80" y="810" width="20" height="15" fill="url(#agentGrad)"/>
  <text x="110" y="822" font-size="11" fill="#5f6368">Agent Layer</text>
  
  <rect x="200" y="810" width="20" height="15" fill="url(#mcpGrad)"/>
  <text x="230" y="822" font-size="11" fill="#5f6368">MCP Server</text>
  
  <rect x="320" y="810" width="20" height="15" fill="url(#gcpGrad)"/>
  <text x="350" y="822" font-size="11" fill="#5f6368">GCP Services</text>
  
  <text x="500" y="822" font-size="11" fill="#5f6368">Required Roles: roles/viewer, roles/serviceusage.serviceUsageViewer, roles/billing.viewer</text>
  
  <text x="80" y="855" font-size="11" fill="#5f6368">Target: SMBs with $50K-$500K monthly cloud spend | Infrastructure Cost: $20-80/month</text>
  <text x="80" y="870" font-size="10" fill="#999">Document Version: v1.1 | February 2025</text>
  
  <!-- Arrowhead marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#5f6368"/>
    </marker>
  </defs>
</svg>
