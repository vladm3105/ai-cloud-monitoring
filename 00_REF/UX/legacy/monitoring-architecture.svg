<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1600" font-family="'Segoe UI', 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <!-- Subtle grid pattern for background -->
    <pattern id="grid" width="24" height="24" patternUnits="userSpaceOnUse">
      <path d="M 24 0 L 0 0 0 24" fill="none" stroke="#e8eaed" stroke-width="0.5" opacity="0.5"/>
    </pattern>
    <!-- Gradient for header -->
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <!-- Tier gradients -->
    <linearGradient id="appTierGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f0f9ff"/>
      <stop offset="100%" style="stop-color:#e0f2fe"/>
    </linearGradient>
    <linearGradient id="llmTierGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fefce8"/>
      <stop offset="100%" style="stop-color:#fef9c3"/>
    </linearGradient>
    <linearGradient id="infraTierGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f0fdf4"/>
      <stop offset="100%" style="stop-color:#dcfce7"/>
    </linearGradient>
    <!-- Drop shadow -->
    <filter id="shadow" x="-2%" y="-2%" width="104%" height="104%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.08"/>
    </filter>
    <filter id="shadowDeep" x="-3%" y="-3%" width="106%" height="106%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.12"/>
    </filter>
    <!-- Arrow marker -->
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto" fill="#64748b">
      <polygon points="0 0, 8 3, 0 6"/>
    </marker>
    <marker id="arrowRed" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto" fill="#ef4444">
      <polygon points="0 0, 8 3, 0 6"/>
    </marker>
    <marker id="arrowAmber" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto" fill="#f59e0b">
      <polygon points="0 0, 8 3, 0 6"/>
    </marker>
    <marker id="arrowGreen" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto" fill="#22c55e">
      <polygon points="0 0, 8 3, 0 6"/>
    </marker>
    <marker id="arrowBlue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto" fill="#3b82f6">
      <polygon points="0 0, 8 3, 0 6"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="1600" fill="#f8fafc"/>
  <rect width="1200" height="1600" fill="url(#grid)"/>

  <!-- ==================== HEADER ==================== -->
  <rect x="40" y="30" width="1120" height="90" rx="12" fill="url(#headerGrad)" filter="url(#shadowDeep)"/>
  <text x="80" y="68" font-size="22" font-weight="700" fill="#ffffff" letter-spacing="0.5">AI Cost Monitoring Agent</text>
  <text x="80" y="98" font-size="14" fill="#94a3b8" letter-spacing="0.3">Monitoring &amp; Observability Architecture</text>
  <rect x="830" y="50" width="300" height="50" rx="8" fill="#1e3a5f" opacity="0.6"/>
  <text x="850" y="72" font-size="11" fill="#93c5fd">Monitoring Stack Cost</text>
  <text x="850" y="90" font-size="16" font-weight="700" fill="#60a5fa">$60‚Äì150/mo</text>
  <text x="990" y="72" font-size="11" fill="#93c5fd">Total RAM</text>
  <text x="990" y="90" font-size="16" font-weight="700" fill="#60a5fa">~5 GB</text>

  <!-- ==================== CUSTOMER / ENTRY ==================== -->
  <!-- Customer icon -->
  <rect x="490" y="150" width="220" height="56" rx="28" fill="#ffffff" stroke="#3b82f6" stroke-width="2" filter="url(#shadow)"/>
  <circle cx="522" cy="178" r="14" fill="#dbeafe"/>
  <circle cx="522" cy="173" r="5" fill="#3b82f6"/>
  <path d="M512 184 Q522 189 532 184" fill="none" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="545" y="183" font-size="14" font-weight="600" fill="#1e40af">SMB Customer</text>

  <!-- Arrow down from customer -->
  <line x1="600" y1="206" x2="600" y2="246" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <text x="612" y="232" font-size="10" fill="#64748b" font-style="italic">"Why did my Vertex AI cost spike?"</text>

  <!-- ==================== TIER 1: APPLICATION ==================== -->
  <rect x="60" y="260" width="1080" height="200" rx="12" fill="url(#appTierGrad)" stroke="#93c5fd" stroke-width="1.5" filter="url(#shadow)"/>
  <!-- Tier label -->
  <rect x="60" y="260" width="220" height="30" rx="12" fill="#3b82f6"/>
  <text x="80" y="281" font-size="12" font-weight="600" fill="#ffffff" letter-spacing="0.5">APPLICATION TIER</text>

  <!-- MCP Server box -->
  <rect x="120" y="310" width="240" height="120" rx="10" fill="#ffffff" stroke="#93c5fd" stroke-width="1.5" filter="url(#shadow)"/>
  <rect x="120" y="310" width="240" height="32" rx="10" fill="#2563eb"/>
  <rect x="120" y="330" width="240" height="12" fill="#2563eb"/>
  <text x="160" y="332" font-size="13" font-weight="700" fill="#ffffff">MCP Server (Agent)</text>
  <text x="140" y="365" font-size="11" fill="#475569">Cloud Run  ‚Ä¢  :8080</text>
  <text x="140" y="385" font-size="10" fill="#64748b">‚Ä¢ Handles customer queries</text>
  <text x="140" y="400" font-size="10" fill="#64748b">‚Ä¢ Calls GCP APIs (BigQuery, etc.)</text>
  <text x="140" y="415" font-size="10" fill="#64748b">‚Ä¢ Instrumented w/ Langfuse SDK</text>

  <!-- Arrow MCP ‚Üí LiteLLM -->
  <line x1="360" y1="370" x2="460" y2="370" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="380" y="360" font-size="9" fill="#64748b">LLM calls</text>

  <!-- LiteLLM Proxy box -->
  <rect x="470" y="310" width="280" height="120" rx="10" fill="#ffffff" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
  <rect x="470" y="310" width="280" height="32" rx="10" fill="#d97706"/>
  <rect x="470" y="330" width="280" height="12" fill="#d97706"/>
  <text x="510" y="332" font-size="13" font-weight="700" fill="#ffffff">‚ö° LiteLLM Proxy (AI Gateway)</text>
  <text x="490" y="365" font-size="11" fill="#475569">Budget Enforcement  ‚Ä¢  :4000</text>
  <text x="490" y="385" font-size="10" fill="#64748b">‚Ä¢ Per-customer budget caps (HARD)</text>
  <text x="490" y="400" font-size="10" fill="#64748b">‚Ä¢ Rate limiting (TPM caps)</text>
  <text x="490" y="415" font-size="10" fill="#64748b">‚Ä¢ Smart model routing + caching</text>

  <!-- Arrow LiteLLM ‚Üí LLM Providers -->
  <line x1="750" y1="370" x2="830" y2="370" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- LLM Providers box -->
  <rect x="840" y="310" width="240" height="120" rx="10" fill="#ffffff" stroke="#a78bfa" stroke-width="1.5" filter="url(#shadow)"/>
  <rect x="840" y="310" width="240" height="32" rx="10" fill="#7c3aed"/>
  <rect x="840" y="330" width="240" height="12" fill="#7c3aed"/>
  <text x="890" y="332" font-size="13" font-weight="700" fill="#ffffff">LLM Providers</text>
  <text x="860" y="365" font-size="11" fill="#475569">External APIs</text>
  <text x="860" y="385" font-size="10" fill="#64748b">‚Ä¢ Anthropic Claude (Sonnet/Haiku)</text>
  <text x="860" y="400" font-size="10" fill="#64748b">‚Ä¢ Google Gemini (Pro/Flash)</text>
  <text x="860" y="415" font-size="10" fill="#64748b">‚Ä¢ Self-hosted models (optional)</text>

  <!-- GCP APIs (separate, connected to MCP) -->
  <rect x="120" y="440" width="240" height="18" rx="4" fill="#e0f2fe"/>
  <text x="150" y="454" font-size="10" font-weight="500" fill="#1e40af">‚Üí GCP: BigQuery ¬∑ Recommender ¬∑ Asset Inv.</text>

  <!-- ==================== DATA FLOW ARROWS (App ‚Üí Observability) ==================== -->

  <!-- LiteLLM ‚Üí Langfuse (traces) -->
  <path d="M 610 430 L 610 500 L 350 500 L 350 545" fill="none" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrowAmber)"/>
  <rect x="390" y="490" width="120" height="18" rx="4" fill="#fef3c7"/>
  <text x="400" y="503" font-size="9" font-weight="500" fill="#92400e">OTLP Traces + Cost</text>

  <!-- LiteLLM ‚Üí Prometheus (metrics) -->
  <path d="M 680 430 L 680 510 L 680 545" fill="none" stroke="#22c55e" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrowGreen)"/>
  <rect x="690" y="510" width="100" height="18" rx="4" fill="#dcfce7"/>
  <text x="700" y="523" font-size="9" font-weight="500" fill="#166534">/metrics scrape</text>

  <!-- MCP ‚Üí Loki (logs) -->
  <path d="M 240 430 L 240 510 L 950 510 L 950 545" fill="none" stroke="#64748b" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrow)"/>
  <rect x="870" y="500" width="70" height="18" rx="4" fill="#f1f5f9"/>
  <text x="880" y="513" font-size="9" font-weight="500" fill="#475569">Log stream</text>

  <!-- ==================== TIER 2: LLM OBSERVABILITY ==================== -->
  <rect x="60" y="555" width="530" height="310" rx="12" fill="url(#llmTierGrad)" stroke="#fbbf24" stroke-width="1.5" filter="url(#shadow)"/>
  <!-- Tier label -->
  <rect x="60" y="555" width="280" height="30" rx="12" fill="#d97706"/>
  <text x="80" y="576" font-size="12" font-weight="600" fill="#ffffff" letter-spacing="0.5">LAYER 2: LLM OBSERVABILITY</text>

  <!-- Langfuse Web -->
  <rect x="100" y="605" width="200" height="100" rx="8" fill="#ffffff" stroke="#fbbf24" stroke-width="1.5" filter="url(#shadow)"/>
  <rect x="100" y="605" width="200" height="28" rx="8" fill="#eab308"/>
  <rect x="100" y="624" width="200" height="9" fill="#eab308"/>
  <text x="135" y="625" font-size="12" font-weight="700" fill="#ffffff">Langfuse Web</text>
  <text x="120" y="657" font-size="10" fill="#64748b">UI + API  ‚Ä¢  :3000</text>
  <text x="120" y="672" font-size="10" fill="#64748b">‚Ä¢ Cost attribution dashboards</text>
  <text x="120" y="687" font-size="10" fill="#64748b">‚Ä¢ Trace inspection + replay</text>
  <text x="120" y="700" font-size="10" fill="#64748b">‚Ä¢ Prompt management</text>

  <!-- Langfuse Worker -->
  <rect x="330" y="605" width="200" height="100" rx="8" fill="#ffffff" stroke="#fbbf24" stroke-width="1.5" filter="url(#shadow)"/>
  <rect x="330" y="605" width="200" height="28" rx="8" fill="#eab308"/>
  <rect x="330" y="624" width="200" height="9" fill="#eab308"/>
  <text x="362" y="625" font-size="12" font-weight="700" fill="#ffffff">Langfuse Worker</text>
  <text x="350" y="657" font-size="10" fill="#64748b">Async trace processor</text>
  <text x="350" y="672" font-size="10" fill="#64748b">‚Ä¢ Ingests OTLP spans</text>
  <text x="350" y="687" font-size="10" fill="#64748b">‚Ä¢ Cost calculation</text>
  <text x="350" y="700" font-size="10" fill="#64748b">‚Ä¢ Token counting</text>

  <!-- Langfuse data stores -->
  <rect x="100" y="725" width="130" height="50" rx="6" fill="#ffffff" stroke="#d4d4d8" stroke-width="1" filter="url(#shadow)"/>
  <text x="120" y="748" font-size="11" font-weight="600" fill="#475569">üêò Postgres</text>
  <text x="120" y="764" font-size="9" fill="#94a3b8">Metadata ‚Ä¢ :5432</text>

  <rect x="245" y="725" width="130" height="50" rx="6" fill="#ffffff" stroke="#d4d4d8" stroke-width="1" filter="url(#shadow)"/>
  <text x="255" y="748" font-size="11" font-weight="600" fill="#475569">‚ö° ClickHouse</text>
  <text x="255" y="764" font-size="9" fill="#94a3b8">Analytics ‚Ä¢ :8123</text>

  <rect x="390" y="725" width="130" height="50" rx="6" fill="#ffffff" stroke="#d4d4d8" stroke-width="1" filter="url(#shadow)"/>
  <text x="415" y="748" font-size="11" font-weight="600" fill="#475569">üî¥ Redis</text>
  <text x="410" y="764" font-size="9" fill="#94a3b8">Queue ‚Ä¢ :6379</text>

  <!-- Key metrics callout -->
  <rect x="100" y="790" width="430" height="55" rx="6" fill="#fffbeb" stroke="#f59e0b" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="120" y="810" font-size="10" font-weight="600" fill="#92400e">KEY LLM METRICS TRACKED:</text>
  <text x="120" y="828" font-size="9" fill="#78350f">Cost/customer ‚Ä¢ Cost/session ‚Ä¢ Token usage (in/out) ‚Ä¢ Model mix ‚Ä¢ Cache hit rate ‚Ä¢ Query classification ‚Ä¢ Margin per tier</text>

  <!-- ==================== TIER 3: INFRASTRUCTURE OBSERVABILITY ==================== -->
  <rect x="610" y="555" width="530" height="310" rx="12" fill="url(#infraTierGrad)" stroke="#86efac" stroke-width="1.5" filter="url(#shadow)"/>
  <!-- Tier label -->
  <rect x="610" y="555" width="330" height="30" rx="12" fill="#16a34a"/>
  <text x="630" y="576" font-size="12" font-weight="600" fill="#ffffff" letter-spacing="0.5">LAYER 3: INFRASTRUCTURE OBSERVABILITY</text>

  <!-- Prometheus -->
  <rect x="650" y="605" width="200" height="100" rx="8" fill="#ffffff" stroke="#86efac" stroke-width="1.5" filter="url(#shadow)"/>
  <rect x="650" y="605" width="200" height="28" rx="8" fill="#16a34a"/>
  <rect x="650" y="624" width="200" height="9" fill="#16a34a"/>
  <text x="698" y="625" font-size="12" font-weight="700" fill="#ffffff">Prometheus</text>
  <text x="670" y="657" font-size="10" fill="#64748b">Metrics collection ‚Ä¢ :9090</text>
  <text x="670" y="672" font-size="10" fill="#64748b">‚Ä¢ Cloud Run scaling/CPU/mem</text>
  <text x="670" y="687" font-size="10" fill="#64748b">‚Ä¢ LiteLLM request metrics</text>
  <text x="670" y="700" font-size="10" fill="#64748b">‚Ä¢ DB health + connections</text>

  <!-- Loki -->
  <rect x="880" y="605" width="200" height="100" rx="8" fill="#ffffff" stroke="#86efac" stroke-width="1.5" filter="url(#shadow)"/>
  <rect x="880" y="605" width="200" height="28" rx="8" fill="#16a34a"/>
  <rect x="880" y="624" width="200" height="9" fill="#16a34a"/>
  <text x="942" y="625" font-size="12" font-weight="700" fill="#ffffff">Loki</text>
  <text x="900" y="657" font-size="10" fill="#64748b">Log aggregation ‚Ä¢ :3100</text>
  <text x="900" y="672" font-size="10" fill="#64748b">‚Ä¢ Application logs</text>
  <text x="900" y="687" font-size="10" fill="#64748b">‚Ä¢ Budget enforcement events</text>
  <text x="900" y="700" font-size="10" fill="#64748b">‚Ä¢ Error + provider failures</text>

  <!-- Promtail -->
  <rect x="650" y="725" width="200" height="50" rx="6" fill="#ffffff" stroke="#d4d4d8" stroke-width="1" filter="url(#shadow)"/>
  <text x="695" y="748" font-size="11" font-weight="600" fill="#475569">üìã Promtail</text>
  <text x="685" y="764" font-size="9" fill="#94a3b8">Log shipping sidecar</text>

  <!-- Alertmanager / Alert Rules callout -->
  <rect x="880" y="725" width="200" height="50" rx="6" fill="#ffffff" stroke="#d4d4d8" stroke-width="1" filter="url(#shadow)"/>
  <text x="910" y="748" font-size="11" font-weight="600" fill="#475569">üîî Alert Rules</text>
  <text x="900" y="764" font-size="9" fill="#94a3b8">Slack ‚Ä¢ Email ‚Ä¢ PagerDuty</text>

  <!-- Key metrics callout -->
  <rect x="650" y="790" width="430" height="55" rx="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="670" y="810" font-size="10" font-weight="600" fill="#166534">KEY INFRA METRICS TRACKED:</text>
  <text x="670" y="828" font-size="9" fill="#14532d">CPU/Mem utilization ‚Ä¢ Cold starts ‚Ä¢ Request latency (p50/p95/p99) ‚Ä¢ Error rates ‚Ä¢ Instance scaling ‚Ä¢ DB connections ‚Ä¢ Disk usage</text>

  <!-- ==================== GRAFANA (UNIFIED) ==================== -->
  <rect x="60" y="900" width="1080" height="240" rx="12" fill="#ffffff" stroke="#6366f1" stroke-width="2" filter="url(#shadowDeep)"/>
  <!-- Grafana header -->
  <rect x="60" y="900" width="1080" height="36" rx="12" fill="#4f46e5"/>
  <rect x="60" y="924" width="1080" height="12" fill="#4f46e5"/>
  <text x="500" y="924" font-size="15" font-weight="700" fill="#ffffff" letter-spacing="1">üìä  GRAFANA ‚Äî UNIFIED DASHBOARDS  ‚Ä¢  :3001</text>

  <!-- Dashboard panels -->
  <!-- Executive -->
  <rect x="90" y="955" width="240" height="80" rx="8" fill="#f5f3ff" stroke="#c4b5fd" stroke-width="1"/>
  <text x="110" y="978" font-size="11" font-weight="700" fill="#5b21b6">üìà Executive Overview</text>
  <text x="110" y="995" font-size="9" fill="#6b7280">Total LLM spend</text>
  <text x="110" y="1008" font-size="9" fill="#6b7280">Revenue vs COGS by tier</text>
  <text x="110" y="1021" font-size="9" fill="#6b7280">Active customers + health</text>

  <!-- LLM Cost -->
  <rect x="350" y="955" width="240" height="80" rx="8" fill="#fefce8" stroke="#fde68a" stroke-width="1"/>
  <text x="370" y="978" font-size="11" font-weight="700" fill="#92400e">üí∞ LLM Cost Operations</text>
  <text x="370" y="995" font-size="9" fill="#6b7280">Real-time $/hour spend rate</text>
  <text x="370" y="1008" font-size="9" fill="#6b7280">Per-customer cost breakdown</text>
  <text x="370" y="1021" font-size="9" fill="#6b7280">Model mix + cache savings</text>

  <!-- Agent Perf -->
  <rect x="610" y="955" width="240" height="80" rx="8" fill="#eff6ff" stroke="#93c5fd" stroke-width="1"/>
  <text x="630" y="978" font-size="11" font-weight="700" fill="#1e40af">ü§ñ Agent Performance</text>
  <text x="630" y="995" font-size="9" fill="#6b7280">Query latency (p50/p95/p99)</text>
  <text x="630" y="1008" font-size="9" fill="#6b7280">Tool call success rates</text>
  <text x="630" y="1021" font-size="9" fill="#6b7280">Conversation analytics</text>

  <!-- Infra -->
  <rect x="870" y="955" width="240" height="80" rx="8" fill="#f0fdf4" stroke="#86efac" stroke-width="1"/>
  <text x="890" y="978" font-size="11" font-weight="700" fill="#166534">üèóÔ∏è Infrastructure</text>
  <text x="890" y="995" font-size="9" fill="#6b7280">Cloud Run scaling + CPU</text>
  <text x="890" y="1008" font-size="9" fill="#6b7280">Database health</text>
  <text x="890" y="1021" font-size="9" fill="#6b7280">Error rates + uptime</text>

  <!-- Data source arrows into Grafana -->
  <path d="M 300 845 L 300 870 L 200 870 L 200 900" fill="none" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrowAmber)"/>
  <path d="M 750 845 L 750 870 L 850 870 L 850 900" fill="none" stroke="#22c55e" stroke-width="1.5" marker-end="url(#arrowGreen)"/>
  <path d="M 980 775 L 1000 775 L 1000 900" fill="none" stroke="#22c55e" stroke-width="1.5" marker-end="url(#arrowGreen)"/>

  <!-- Alerts output -->
  <rect x="90" y="1050" width="1020" height="60" rx="8" fill="#fef2f2" stroke="#fca5a5" stroke-width="1.5"/>
  <text x="110" y="1074" font-size="11" font-weight="700" fill="#991b1b">üö® ALERTING PIPELINE</text>
  <text x="110" y="1094" font-size="10" fill="#7f1d1d">Cost spike (3√ó avg) ‚Üí CRITICAL    |    Customer 80% budget ‚Üí WARNING    |    Error rate &gt;5% ‚Üí CRITICAL    |    Provider down ‚Üí CRITICAL + fallback verify</text>

  <!-- ==================== COST PROTECTION DETAIL ==================== -->
  <rect x="60" y="1140" width="1080" height="210" rx="12" fill="#fff7ed" stroke="#fb923c" stroke-width="2" filter="url(#shadowDeep)"/>
  <rect x="60" y="1140" width="1080" height="36" rx="12" fill="#ea580c"/>
  <rect x="60" y="1164" width="1080" height="12" fill="#ea580c"/>
  <text x="400" y="1164" font-size="15" font-weight="700" fill="#ffffff" letter-spacing="1">üõ°Ô∏è  COST PROTECTION ‚Äî LAYERED DEFENSE</text>

  <!-- Defense layers -->
  <!-- Layer 1 -->
  <rect x="90" y="1195" width="240" height="70" rx="8" fill="#ffffff" stroke="#ef4444" stroke-width="2" filter="url(#shadow)"/>
  <text x="110" y="1218" font-size="11" font-weight="700" fill="#dc2626">L1: Budget Caps</text>
  <text x="110" y="1235" font-size="9" fill="#6b7280">PROACTIVE ‚Äî blocks before cost</text>
  <text x="110" y="1250" font-size="9" fill="#6b7280">Per-customer monthly limits</text>
  <text x="110" y="1263" font-size="9" fill="#dc2626" font-weight="600">$0.50 max per session</text>

  <!-- Layer 2 -->
  <rect x="350" y="1195" width="240" height="70" rx="8" fill="#ffffff" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
  <text x="370" y="1218" font-size="11" font-weight="700" fill="#d97706">L2: Rate Limiting</text>
  <text x="370" y="1235" font-size="9" fill="#6b7280">PROACTIVE ‚Äî throttles velocity</text>
  <text x="370" y="1250" font-size="9" fill="#6b7280">50K tokens/min cap</text>
  <text x="370" y="1263" font-size="9" fill="#d97706" font-weight="600">100 max calls/session</text>

  <!-- Layer 3 -->
  <rect x="610" y="1195" width="240" height="70" rx="8" fill="#ffffff" stroke="#eab308" stroke-width="2" filter="url(#shadow)"/>
  <text x="630" y="1218" font-size="11" font-weight="700" fill="#ca8a04">L3: Smart Routing</text>
  <text x="630" y="1235" font-size="9" fill="#6b7280">COST OPTIMIZATION ‚Äî auto-route</text>
  <text x="630" y="1250" font-size="9" fill="#6b7280">Simple ‚Üí Haiku/Flash ($0.001)</text>
  <text x="630" y="1263" font-size="9" fill="#ca8a04" font-weight="600">Complex ‚Üí Sonnet/Pro ($0.05)</text>

  <!-- Layer 4 -->
  <rect x="870" y="1195" width="240" height="70" rx="8" fill="#ffffff" stroke="#22c55e" stroke-width="2" filter="url(#shadow)"/>
  <text x="890" y="1218" font-size="11" font-weight="700" fill="#16a34a">L4: Monitoring Alerts</text>
  <text x="890" y="1235" font-size="9" fill="#6b7280">REACTIVE ‚Äî detect + notify</text>
  <text x="890" y="1250" font-size="9" fill="#6b7280">3√ó rate-of-change detection</text>
  <text x="890" y="1263" font-size="9" fill="#16a34a" font-weight="600">50/80/95/100% thresholds</text>

  <!-- Arrows between layers -->
  <text x="338" y="1230" font-size="14" fill="#d4d4d8">‚Üí</text>
  <text x="598" y="1230" font-size="14" fill="#d4d4d8">‚Üí</text>
  <text x="858" y="1230" font-size="14" fill="#d4d4d8">‚Üí</text>

  <!-- Degradation flow -->
  <rect x="90" y="1280" width="1020" height="50" rx="6" fill="#fef9c3" stroke="#eab308" stroke-width="1"/>
  <text x="110" y="1300" font-size="10" font-weight="600" fill="#854d0e">GRACEFUL DEGRADATION PATH:</text>
  <text x="110" y="1318" font-size="10" fill="#713f12">Normal operation ‚Üí 95% budget: route to cheaper model ‚Üí 100% budget: block + inform customer ‚Üí Ops alert + session log for review</text>

  <!-- ==================== LEGEND ==================== -->
  <rect x="60" y="1370" width="1080" height="80" rx="12" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/>
  <text x="90" y="1395" font-size="11" font-weight="700" fill="#334155">LEGEND</text>

  <!-- Color key -->
  <rect x="90" y="1408" width="16" height="12" rx="3" fill="#2563eb"/>
  <text x="114" y="1419" font-size="10" fill="#475569">Application</text>

  <rect x="210" y="1408" width="16" height="12" rx="3" fill="#d97706"/>
  <text x="234" y="1419" font-size="10" fill="#475569">AI Gateway (LiteLLM)</text>

  <rect x="390" y="1408" width="16" height="12" rx="3" fill="#eab308"/>
  <text x="414" y="1419" font-size="10" fill="#475569">LLM Observability (Langfuse)</text>

  <rect x="600" y="1408" width="16" height="12" rx="3" fill="#16a34a"/>
  <text x="624" y="1419" font-size="10" fill="#475569">Infrastructure (Prometheus/Loki)</text>

  <rect x="830" y="1408" width="16" height="12" rx="3" fill="#4f46e5"/>
  <text x="854" y="1419" font-size="10" fill="#475569">Unified Dashboards (Grafana)</text>

  <!-- Flow key -->
  <line x1="90" y1="1440" x2="120" y2="1440" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="130" y="1444" font-size="10" fill="#475569">Request flow</text>

  <line x1="270" y1="1440" x2="300" y2="1440" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrowAmber)"/>
  <text x="310" y="1444" font-size="10" fill="#475569">Trace/metric export</text>

  <rect x="470" y="1434" width="80" height="14" rx="3" fill="#fef2f2" stroke="#fca5a5" stroke-width="1"/>
  <text x="520" y="1444" font-size="10" fill="#475569">Critical alert</text>

  <!-- Tech labels -->
  <text x="680" y="1444" font-size="10" fill="#94a3b8">All components: Open-source  ‚Ä¢  Self-hosted  ‚Ä¢  Docker Compose / Cloud Run  ‚Ä¢  ~$60-150/mo</text>

  <!-- ==================== PHASE ROLLOUT ==================== -->
  <rect x="60" y="1465" width="1080" height="100" rx="12" fill="#ffffff" stroke="#e2e8f0" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="90" y="1490" font-size="11" font-weight="700" fill="#334155">PHASED ROLLOUT</text>

  <!-- Phase boxes -->
  <rect x="90" y="1505" width="180" height="40" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="110" y="1522" font-size="10" font-weight="600" fill="#92400e">Phase 1 (Wk 1-2)</text>
  <text x="110" y="1536" font-size="9" fill="#78350f">LiteLLM + Langfuse</text>

  <text x="278" y="1525" font-size="12" fill="#d4d4d8">‚Üí</text>

  <rect x="300" y="1505" width="180" height="40" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="1.5"/>
  <text x="320" y="1522" font-size="10" font-weight="600" fill="#166534">Phase 2 (Wk 3-4)</text>
  <text x="320" y="1536" font-size="9" fill="#14532d">Prometheus + Grafana</text>

  <text x="488" y="1525" font-size="12" fill="#d4d4d8">‚Üí</text>

  <rect x="510" y="1505" width="180" height="40" rx="6" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5"/>
  <text x="530" y="1522" font-size="10" font-weight="600" fill="#166534">Phase 3 (Wk 4-5)</text>
  <text x="530" y="1536" font-size="9" fill="#14532d">Loki + Promtail</text>

  <text x="698" y="1525" font-size="12" fill="#d4d4d8">‚Üí</text>

  <rect x="720" y="1505" width="180" height="40" rx="6" fill="#f5f3ff" stroke="#a78bfa" stroke-width="1.5"/>
  <text x="740" y="1522" font-size="10" font-weight="600" fill="#5b21b6">Phase 4 (Wk 5-6)</text>
  <text x="740" y="1536" font-size="9" fill="#4c1d95">Advanced dashboards</text>

  <text x="908" y="1525" font-size="12" fill="#d4d4d8">‚Üí</text>

  <rect x="930" y="1505" width="180" height="40" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="950" y="1522" font-size="10" font-weight="600" fill="#475569">Phase 5 (Optional)</text>
  <text x="950" y="1536" font-size="9" fill="#64748b">Tempo (dist. tracing)</text>

</svg>
